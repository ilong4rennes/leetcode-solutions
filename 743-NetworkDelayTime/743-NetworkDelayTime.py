if len(dist_map) != N:
    return -1
return max(dist_map.values())